{"version":3,"file":"component---src-pages-guides-general-concepts-client-side-caching-index-md-89577b241f3251b5aeaf.js","mappings":"iSAMaA,EAAe,CAAC,EACvBC,EAAc,CAClBD,gBAEIE,EAAYC,EAAAA,EACH,SAASC,EAAUC,GAG/B,IAHgC,WACjCC,GAEDD,EADIE,GAAKC,EAAAA,EAAAA,GAAAH,EAAAI,GAER,OAAOC,EAAAA,EAAAA,KAACR,GAASS,EAAAA,EAAAA,GAAA,GAAKV,EAAiBM,EAAK,CAAED,WAAYA,EAAYM,QAAQ,eAG5EF,EAAAA,EAAAA,KAAA,MACE,GAAM,uBACH,wBACLA,EAAAA,EAAAA,KAAA,SAAK,2FACLA,EAAAA,EAAAA,KAAA,MACE,GAAM,YACH,aACLA,EAAAA,EAAAA,KAAA,SAAK,uLAGLA,EAAAA,EAAAA,KAAA,SAAK,qJAELA,EAAAA,EAAAA,KAAA,SAAK,sSAGLA,EAAAA,EAAAA,KAAA,MACE,GAAM,0BACH,2BACLA,EAAAA,EAAAA,KAAA,SAAK,MAAIA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACnB,KAAQ,4EACL,kBAAsB,4OAE7BH,EAAAA,EAAAA,KAAA,MACE,GAAM,wBACH,yBACLA,EAAAA,EAAAA,KAAA,SAAK,yCAAuCA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACtD,KAAQ,oDACL,WAAe,2DACoBH,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACpD,KAAQ,gGACL,sBAA0B,gBACjCH,EAAAA,EAAAA,KAAA,SAAK,8LAELA,EAAAA,EAAAA,KAAA,SAAK,6BAA2BA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IAC1C,KAAQ,8EACL,sBAA0B,8BACjCH,EAAAA,EAAAA,KAAA,MACE,GAAM,0BACH,2BACLA,EAAAA,EAAAA,KAAA,SAAK,QAAMA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACrB,KAAQ,+GACL,0BAA8B,kLAErCH,EAAAA,EAAAA,KAAA,SAAK,8GAELA,EAAAA,EAAAA,KAAA,cACEA,EAAAA,EAAAA,KAAA,SAAOG,WAAW,UAChBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBACLH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBAGTH,EAAAA,EAAAA,KAAA,SAAOG,WAAW,UAChBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,MACLH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,0BAEPH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,KAAM,KAAM,SACjBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,sBAEPH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,wBAAyB,IAAK,SAAU,IAAK,MAAO,IAAK,MAAO,IAAK,OAAQ,IAAK,WACvFH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,2BAKXH,EAAAA,EAAAA,KAAA,MACE,GAAM,iBACH,kBACLA,EAAAA,EAAAA,KAAA,SAAK,QAAMA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACrB,KAAQ,sHACL,iBAAqB,2KAE5BH,EAAAA,EAAAA,KAAA,SAAK,6EACLA,EAAAA,EAAAA,KAAA,cACEA,EAAAA,EAAAA,KAAA,SAAOG,WAAW,UAChBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBACLH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBAGTH,EAAAA,EAAAA,KAAA,SAAOG,WAAW,UAChBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,KAAM,WACXH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBAIXH,EAAAA,EAAAA,KAAA,MACE,GAAM,eACH,gBACLA,EAAAA,EAAAA,KAAA,SAAK,QAAMA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACrB,KAAQ,sHACL,eAAmB,iKAE1BH,EAAAA,EAAAA,KAAA,SAAK,gHACLA,EAAAA,EAAAA,KAAA,SAAK,sFACLA,EAAAA,EAAAA,KAAA,cACEA,EAAAA,EAAAA,KAAA,SAAOG,WAAW,UAChBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBACLH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,kBAGTH,EAAAA,EAAAA,KAAA,SAAOG,WAAW,UAChBH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,UACbH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,WACLH,EAAAA,EAAAA,KAAA,MAAIG,WAAW,KACb,MAAS,MACN,+CAIXH,EAAAA,EAAAA,KAAA,SAAK,+PAELA,EAAAA,EAAAA,KAAA,MACE,GAAM,wCACH,yCACLA,EAAAA,EAAAA,KAAA,SAAK,yLAC0BA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACzC,KAAQ,6DACL,iBAAqB,4DAC5BH,EAAAA,EAAAA,KAAA,SAAK,uDAAqDA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAM,uBAAoC,eAAaH,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IAClJ,KAAQ,yDACL,wBAA4B,8GAEnCH,EAAAA,EAAAA,KAAA,SAAK,2GACwBA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAM,eAA4B,iBAAeH,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAM,SAAsB,gBACxJH,EAAAA,EAAAA,KAAA,SAAK,wCAAsCA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IACrD,KAAQ,8FACL,0BAA8B,UAGzC,CAEAT,EAAWU,gBAAiB,C","sources":["webpack://commerce-pwa-studio/./src/pages/guides/general-concepts/client-side-caching/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/commerce-pwa-studio/commerce-pwa-studio/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"client-side-caching\"\n    }}>{`Client-side caching`}</h1>\n    <p>{`Client-side caching is the storage of network data to a local cache for future re-use.`}</p>\n    <h2 {...{\n      \"id\": \"overview\"\n    }}>{`Overview`}</h2>\n    <p>{`Client-server communication is slow and expensive.\nPerformance is an important feature for any Progressive Web Application (PWA), so\nrequests to the server should be minimized.`}</p>\n    <p>{`Offline mode is also a required feature for a PWA.\nIn offline mode, the application must be able to serve pages that have been recently viewed.`}</p>\n    <p>{`Applications implement these features with the help of a client-side cache.\nAfter the application fetches network data, it stores that resource in a local cache.\nOnce a resource has been cached, the service worker uses the cache on future requests for that resource to boost performance.`}</p>\n    <h2 {...{\n      \"id\": \"service-worker-caching\"\n    }}>{`Service Worker caching`}</h2>\n    <p>{`A `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/web/ilt/pwa/introduction-to-service-worker\"\n      }}>{`service worker`}</a>{` is a JavaScript file that runs in a separate thread from the main execution thread in a web application.\nService workers can intercept network requests and fetch cached data or store results from a network request into the cache.`}</p>\n    <h3 {...{\n      \"id\": \"venia-service-worker\"\n    }}>{`Venia service worker`}</h3>\n    <p>{`Venia's service worker uses Google's `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/web/tools/workbox/\"\n      }}>{`Workbox`}</a>{` library.\nIts behavior is defined in files inside the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/blob/develop/packages/venia-concept/src/ServiceWorker/\"\n      }}>{`src/ServiceWorker/`}</a>{` directory.`}</p>\n    <p>{`You do not need to use Workbox to define service worker behavior, but\nWorkbox makes this task easier by removing boilerplate code that is always used when working with service workers.`}</p>\n    <p>{`Venia uses the following `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/web/tools/workbox/modules/workbox-strategies\"\n      }}>{`caching strategies`}</a>{` with its service worker:`}</p>\n    <h4 {...{\n      \"id\": \"stale-while-revalidate\"\n    }}>{`Stale-while-revalidate`}</h4>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/#stale-while-revalidate\"\n      }}>{`stale-while-revalidate`}</a>{` strategy tells the service worker to use a cached response if it exists.\nA separate network request is made for that resource and the cache is updated for future requests.`}</p>\n    <p>{`This strategy is used when the most up to date version of a resource is not necessary for an application.`}</p>\n    {/* prettier-ignore-start */}\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Route pattern`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The application root`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/.`}{`\\\\`}{`.js$`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`JavaScript files`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/\\\\/media\\\\/catalog.*`}{`.`}{`(?:png`}{`|`}{`gif`}{`|`}{`jpg`}{`|`}{`jpeg`}{`|`}{`svg)$/`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Catalog image files`}</td>\n        </tr>\n      </tbody>\n    </table>\n    {/* prettier-ignore-end */}\n    <h4 {...{\n      \"id\": \"network-first\"\n    }}>{`Network first`}</h4>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/#network-falling-back-to-cache\"\n      }}>{`network first`}</a>{` strategy tells the service worker to get a resource from the network first.\nIf a network connection cannot be made, the service worker uses the cache as a fallback.`}</p>\n    <p>{`This strategy is used for data that may change frequently on the server.`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Route pattern`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`\\\\`}{`.html$`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`HTML pages`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <h4 {...{\n      \"id\": \"cache-first\"\n    }}>{`Cache first`}</h4>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/#cache-falling-back-to-network\"\n      }}>{`cache first`}</a>{` strategy tells the service worker to use the data from the cache.\nUnlike the stale-while-revalidate strategy, no network call is made to update the cache.`}</p>\n    <p>{`If a response is not found in the cache, a network call is made to get the resource and cache the response.`}</p>\n    <p>{`This strategy is used for non-critical assets that do not get updated very often.`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Route pattern`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`images`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Image files served from the application`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`When using service workers, you should add a width parameter to your images so that the correct image is returned from the cache.\nIf an image does not have a width parameter, a cached image with the same name but an incorrect size could be returned.`}</p>\n    <h2 {...{\n      \"id\": \"caching-in-the-apollo-graphql-client\"\n    }}>{`Caching in the Apollo GraphQL client`}</h2>\n    <p>{`The Venia implementation storefront uses the Apollo GraphQL client to make requests to the Adobe Commerce or Magento Open Source GraphQL endpoint.\nIt also incorporates the default `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.apollographql.com/docs/react/advanced/caching\"\n      }}>{`InMemoryCache`}</a>{` implementation to add caching abilities to the client.`}</p>\n    <p>{`The cache is persisted between browser sessions in `}<inlineCode parentName=\"p\">{`window.localstorage`}</inlineCode>{` using the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/apollographql/apollo-cache-persist\"\n      }}>{`apollo-cache-persist`}</a>{` module.\nThis lets the Apollo client maintain its cached data even when the user closes the application.`}</p>\n    <p>{`By default, InMemoryCache uses a cache first strategy for all queries.\nThis strategy is set using the `}<inlineCode parentName=\"p\">{`fetchPolicy`}</inlineCode>{` prop on the `}<inlineCode parentName=\"p\">{`Query`}</inlineCode>{` component.`}</p>\n    <p>{`Caching for Apollo is set up in the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/magento/pwa-studio/blob/master/packages/venia-ui/lib/drivers/adapter.js\"\n      }}>{`src/drivers/adapter.js`}</a>{` file.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","props","_objectWithoutProperties","_excluded","mdx","_extends","mdxType","parentName","isMDXComponent"],"sourceRoot":""}